# 快速配置参考卡片

## 🎥 系统信息

**设备**：复眼型阵列监控摄像机  
**镜头**：52 个（4 主镜头 + 48 分镜头）  
**全景**：4 主镜头拼接，32:9 比例  

---

## ✅ 当前配置（已更新）

### SDK 登录配置

```typescript
const LOGIN_CONFIG = {
  server: '10.10.18.242',
  wsPort: 7777,          // 中心服务 WebSocket
  userId: 'aqcenter55', // ✅ 已更新
  password: '123',      // ✅ 已更新
  debug: true,
};
```

**位置**：`src/pages/MonitoringPage.tsx` 第 17-23 行

---

## 🔑 服务账号密码

| 服务 | 地址 | 端口 | 账号 | 密码 | 用途 |
|------|------|------|------|------|------|
| 中心服务 | 10.10.18.242 | 8899 / WS:7777 | aqcenter55 | 123 | SDK 登录 ✅ |
| 流媒体服务 | 10.10.18.242 | 8866 / WS:7788 | akmts55 | 123 | 视频流 |
| 拼接服务 | 10.10.18.242 | 8081 | akss55 | 123 | 全景拼接 |
| 录像服务 | 10.10.18.242 | 8081 | akrs55 | 123 | 录像回放 |

---

## 🔌 端口映射

| 端口 | 服务 | 协议 | 说明 |
|------|------|------|------|
| 8081 | 认证 API | HTTP | 统一认证接口 |
| 8899 | 中心服务 | HTTP | 控制管理 |
| 7777 | 中心服务 | WebSocket | **消息控制** ← SDK 使用 |
| 8866 | 流媒体服务 | HTTP | 视频管理 |
| 7788 | 流媒体服务 | WebSocket | **视频流传输** ← SDK 使用 |

---

## 📊 播放全景画面所需信息

### 从 CMD: 30013 获取

```javascript
// 拼接列表消息
{
  "CMD": 30013,
  "StitchServerArr": [{
    "StitchID": "akss55",           // ✅ 拼接服务 ID
    "Status": 1,                    // ✅ 在线状态
    "StitcherArr": [{
      "Index": 0,                   // ✅ 拼接索引
      "MtsIP": "10.10.18.242",      // ✅ 流媒体 IP
      "MtsWsPort": 7788,            // ✅ 流媒体 WebSocket 端口
      "CamID": "...",               // ✅ 摄像机 ID
      "ChnArr": [{
        "VideoID": 99999            // ✅ 全景视频 ID
      }]
    }]
  }]
}
```

### 传给 AnkTechPlayer

```tsx
<AnkTechPlayer
  mediaId={99999}              // VideoID
  mts="10.10.18.242:7788"      // MtsIP:MtsWsPort
  StitchID="akss55"            // StitchID
  StitchIndex={0}              // Index
  CamID="compound_eye_camera"  // CamID
/>
```

---

## 📊 播放分镜头所需信息

### 从 CMD: 30007 获取

```javascript
// 通道列表消息（48 个分镜头）
{
  "CMD": 30007,
  "ChannelArray": [
    {
      "CamID": "camera_01",         // ✅ 摄像机 ID
      "ChnID": "camera_01_0",       // ✅ 通道 ID
      "ChnName": "分镜头1",
      "Status": 1,                  // ✅ 在线状态
      "MtsIP": "10.10.18.242",      // ✅ 流媒体 IP
      "MtsWsPort": 7788,            // ✅ 流媒体 WebSocket 端口
      "MainVideoID": 10001,         // ✅ 主流视频 ID
      "SubVideoID": 10002           // ✅ 子流视频 ID
    }
    // ... 48 个通道
  ]
}
```

### 传给 AnkTechPlayer

```tsx
<AnkTechPlayer
  mediaId={10001}              // MainVideoID
  mts="10.10.18.242:7788"      // MtsIP:MtsWsPort
  CamID="camera_01"            // CamID
  ChnID="camera_01_0"          // ChnID
/>
```

---

## 🚀 快速启动

```bash
# 1. 进入项目目录
cd camera-anktech-system

# 2. 启动开发服务器
pnpm dev

# 3. 打开浏览器
http://localhost:3000

# 4. 查看控制台（F12）
检查登录和设备数据
```

---

## 🎯 预期结果

### 左侧设备列表显示

```
📹 设备列表
├── 🔗 全景拼接服务 (在线)
│   └── 全景通道 (32:9)
│
├── 📷 摄像头 1 (在线)
│   └── 通道 1
│
├── 📷 摄像头 2 (在线)
│   └── 通道 2
│
... (总共 52 个摄像头，48 个分镜头通道)
```

### 右侧视频区域

- **上方**：32:9 全景画面（4 主镜头拼接）
- **下方**：1 个主视频 + 4 个子视频（分镜头）

---

## 🐛 常见问题

### Q1: 拼接列表为空？

**检查**：
- 拼接服务（akss55）是否启动？
- 4 个主镜头是否在线？
- 数据库中是否配置了拼接服务？

### Q2: 分镜头列表为空？

**检查**：
- 48 个分镜头是否配置？
- 摄像头是否在线？

### Q3: 视频黑屏？

**检查**：
- 流媒体服务（akmts55）是否运行？
- 端口 7788 是否开放？
- Network → WS 中是否有视频流连接？

---

## 📞 调试命令

```javascript
// 查看所有设备
__debugTreeData

// 查看拼接服务
__debugTreeData.filter(d => d.type === 'stitch')

// 查看分镜头
__debugTreeData.flatMap(d => d.channels || [])

// 手动刷新
__debugRefreshDevices()
```

---

## 📖 相关文档

- `系统配置文档.md` - 详细的服务器配置
- `完整使用指南.md` - 使用步骤和代码示例
- `AnkTechPlayer.tsx` - 播放组件源码

---

## ⚡ 一句话总结

**登录中心服务（aqcenter55/123）→ 获取拼接列表 → 自动播放 32:9 全景 → 点击播放 48 个分镜头**


