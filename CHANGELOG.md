# æ›´æ–°æ—¥å¿—

## 2025-11-03 - åˆå§‹ç‰ˆæœ¬

### ğŸ‰ é¡¹ç›®åˆ›å»º

åŸºäºåŸ camera_system é¡¹ç›®ï¼Œä½¿ç”¨ AnkTech JS SDK æ›¿ä»£ ffmpeg è½¬æµæ–¹å¼é‡æ„ã€‚

### âœ¨ æ–°å¢åŠŸèƒ½

- **AnkTech SDK é›†æˆ**
  - ä½¿ç”¨ AnkTech JS SDK è¿›è¡Œè§†é¢‘æµç®¡ç†
  - å®ç° AnkTechService æœåŠ¡å±‚å°è£…
  - åˆ›å»º useAnkTech React Hook
  - å®ç° AnkTechPlayer è§†é¢‘æ’­æ”¾å™¨ç»„ä»¶

- **æ ¸å¿ƒåŠŸèƒ½**
  - ç”¨æˆ·ç™»å½•/ç™»å‡º
  - è®¾å¤‡åˆ—è¡¨å±•ç¤ºï¼ˆæ ‘å½¢ç»“æ„ï¼‰
  - å¤šè·¯è§†é¢‘åŒæ—¶æ’­æ”¾ï¼ˆ1ä¸ªä¸»è§†é¢‘ + 4ä¸ªå­è§†é¢‘ï¼‰
  - è§†é¢‘æµå®æ—¶æ§åˆ¶ï¼ˆåˆ›å»º/å…³é—­ï¼‰
  - è§†é¢‘æˆªå›¾åŠŸèƒ½
  - è®¾å¤‡çŠ¶æ€å®æ—¶åŒæ­¥

### ğŸ”§ æŠ€æœ¯æ¶æ„

- **å‰ç«¯æ¡†æ¶**: React 18 + TypeScript
- **æ„å»ºå·¥å…·**: Vite 7.1.12
- **UI æ¡†æ¶**: Tailwind CSS + Radix UI
- **è·¯ç”±**: React Router v6
- **SDK**: AnkTech JS SDK (ESM ç‰ˆæœ¬)

### ğŸ“ ç›®å½•ç»“æ„

```
camera-anktech-system/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ assets/anktech/        # AnkTech SDK
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ common/            # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ monitoring/        # ç›‘æ§ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ui/                # UI ç»„ä»¶åº“
â”‚   â”œâ”€â”€ hooks/                 # React Hooks
â”‚   â”œâ”€â”€ pages/                 # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ services/              # æœåŠ¡å±‚
â”‚   â””â”€â”€ types/                 # ç±»å‹å®šä¹‰
```

### ğŸ”„ ä¸åŸç³»ç»Ÿçš„ä¸»è¦å˜åŒ–

| ç‰¹æ€§ | åŸç³»ç»Ÿ | æ–°ç³»ç»Ÿ |
|------|--------|--------|
| è§†é¢‘ä¼ è¾“ | ffmpeg + HLS | AnkTech SDK ç›´è¿ |
| æœåŠ¡å™¨ä¾èµ– | éœ€è¦ stream-server.js | æ— éœ€é¢å¤–æœåŠ¡å™¨ |
| å»¶è¿Ÿ | 2-5ç§’ | <1ç§’ |
| åŠŸèƒ½æ”¯æŒ | åŸºç¡€æ’­æ”¾ | å®Œæ•´åŠŸèƒ½æ”¯æŒ |

### ğŸ› ä¿®å¤çš„é—®é¢˜

- âœ… ä¿®å¤ AnkTech SDK å¯¼å…¥æ–¹å¼ï¼ˆä½¿ç”¨å‘½åå¯¼å‡ºè€Œéé»˜è®¤å¯¼å‡ºï¼‰
- âœ… ä¼˜åŒ– TypeScript ç±»å‹å®šä¹‰
- âœ… ç®€åŒ–é¡¹ç›®ç»“æ„ï¼Œç§»é™¤ä¸å¿…è¦çš„ä¾èµ–

### ğŸ“ å·²çŸ¥é—®é¢˜

- [ ] éœ€è¦å®é™…çš„ AnkTech æœåŠ¡å™¨ç¯å¢ƒè¿›è¡Œå®Œæ•´æµ‹è¯•
- [ ] éƒ¨åˆ†é«˜çº§åŠŸèƒ½ï¼ˆPTZæ§åˆ¶ã€ROIè®¾ç½®ç­‰ï¼‰éœ€è¦åœ¨å®é™…ç¯å¢ƒä¸­éªŒè¯

### ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’

- [ ] æ·»åŠ å½•åƒåŠŸèƒ½
- [ ] å®ç° PTZ äº‘å°æ§åˆ¶
- [ ] æ·»åŠ  ROI åŒºåŸŸé€‰æ‹©
- [ ] å®ç°æ‹¼æ¥è§†é¢‘æ”¯æŒ
- [ ] æ·»åŠ å‘Šè­¦åŠŸèƒ½
- [ ] å®Œå–„é”™è¯¯å¤„ç†å’Œæ—¥å¿—

### ğŸ“¦ ä¾èµ–è¯´æ˜

**ä¸»è¦ä¾èµ–**:
- react: ^18.0.0
- react-dom: ^18.0.0
- react-router-dom: ^6.30.0
- tailwindcss: ^3.4.11
- @radix-ui/*: UI ç»„ä»¶åº“

**å¼€å‘ä¾èµ–**:
- vite: ^7.1.12
- typescript: ~5.7.2
- @vitejs/plugin-react: ^5.1.0

### ğŸ¯ æ ¸å¿ƒå®ç°

#### 1. AnkTech SDK æœåŠ¡å±‚ (`AnkTechService.ts`)

```typescript
// ä¸»è¦åŠŸèƒ½
- login() / logout()           // ç™»å½•ç™»å‡º
- createStream() / closeStream() // æµæ§åˆ¶
- screenshot()                 // æˆªå›¾
- getDeviceList()             // è·å–è®¾å¤‡
- ptz() / setRoi()            // æ§åˆ¶åŠŸèƒ½
```

#### 2. React Hook (`useAnkTech.ts`)

```typescript
// æä¾›çš„çŠ¶æ€å’Œæ–¹æ³•
- isLoggedIn                  // ç™»å½•çŠ¶æ€
- cameras, channels, stitches // è®¾å¤‡æ•°æ®
- treeData                    // æ ‘å½¢ç»“æ„
- login() / logout()          // ç™»å½•æ§åˆ¶
```

#### 3. è§†é¢‘æ’­æ”¾å™¨ (`AnkTechPlayer.tsx`)

```typescript
// ä¸»è¦ç‰¹æ€§
- è‡ªåŠ¨ç®¡ç†è§†é¢‘æµç”Ÿå‘½å‘¨æœŸ
- æ”¯æŒæ‹¼æ¥è§†é¢‘
- é”™è¯¯å¤„ç†
- å“åº”å¼è®¾è®¡
```

### ğŸ” è°ƒè¯•ä¿¡æ¯

**æµè§ˆå™¨æ§åˆ¶å°è¾“å‡º**:
- `[AnkTech] SDKç‰ˆæœ¬: xxx` - SDK åˆå§‹åŒ–
- `[AnkTech] ç™»å½•æˆåŠŸ` - ç™»å½•çŠ¶æ€
- `[AnkTech] æ”¶åˆ°æ¶ˆæ¯: CMD` - WebSocket æ¶ˆæ¯
- `[AnkTechPlayer] è§†é¢‘æµåˆ›å»ºæˆåŠŸ` - è§†é¢‘æµçŠ¶æ€

### ğŸ“– ä½¿ç”¨è¯´æ˜

1. **å®‰è£…ä¾èµ–**: `pnpm install`
2. **å¼€å‘æ¨¡å¼**: `pnpm dev`
3. **æ„å»º**: `pnpm build`
4. **é¢„è§ˆ**: `pnpm preview`

### âš™ï¸ ç¯å¢ƒè¦æ±‚

- Node.js: >=20.19.0 || >=22.12.0
- pnpm: æ¨èæœ€æ–°ç‰ˆæœ¬
- æµè§ˆå™¨: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+

### ğŸ” é…ç½®è¯´æ˜

ä¿®æ”¹ `src/pages/MonitoringPage.tsx` ä¸­çš„ç™»å½•é…ç½®:

```typescript
const LOGIN_CONFIG = {
  userId: 'your_username',
  password: 'your_password',
  debug: true,
};
```

### ğŸ¤ è´¡çŒ®æŒ‡å—

ä¿ç•™åŸæœ‰ UI é£æ ¼å’Œäº¤äº’é€»è¾‘ï¼Œç¡®ä¿ç”¨æˆ·ä½“éªŒä¸€è‡´æ€§ã€‚

