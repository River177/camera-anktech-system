# 复眼型阵列监控摄像机系统配置

## 📹 硬件配置

### 摄像机组成
- **总镜头数**：52 个
- **主镜头**：4 个（用于拼接全景）
- **分镜头**：48 个（独立视频流）

### 输出画面
- **全景画面**：4 个主镜头拼接
- **画面比例**：32:9（超宽全景）

---

## 🖥️ 服务器配置

**服务器地址**：`10.10.18.242`

### 1. 中心服务（AQ Center）

| 配置项 | 值 |
|--------|-----|
| 服务名称 | 中心服务 |
| 监听端口 | 8899 |
| WebSocket 端口 | 7777 |
| 认证地址 | 10.10.18.242:8081 |
| 登录账号 | `aqcenter55` |
| 登录密码 | `123` |

**用途**：
- 设备管理
- WebSocket 消息通信
- 设备列表、通道列表获取

---

### 2. 流媒体服务（AQ MTS）

| 配置项 | 值 |
|--------|-----|
| 服务名称 | 流媒体服务 |
| 监听端口 | 8866 |
| WebSocket 端口 | 7788 |
| 认证地址 | 10.10.18.242:8081 |
| 登录账号 | `akmts55` |
| 登录密码 | `123` |

**用途**：
- 视频流传输
- 实时播放
- 录像回放

---

### 3. 拼接服务（AQ SS）

| 配置项 | 值 |
|--------|-----|
| 服务名称 | 拼接服务 |
| 认证地址 | 10.10.18.242:8081 |
| 登录账号 | `akss55` |
| 登录密码 | `123` |

**用途**：
- 4 个主镜头拼接
- 生成 32:9 全景画面
- 拼接建模

---

### 4. 录像服务（AQ RS）

| 配置项 | 值 |
|--------|-----|
| 服务名称 | 录像服务 |
| 认证地址 | 10.10.18.242:8081 |
| 登录账号 | `akrs55` |
| 登录密码 | `123` |
| 录像路径 | `/media/data/akrs` |

**用途**：
- 视频录制
- 录像存储
- 录像回放

---

## 🔌 端口总览

| 端口 | 服务 | 用途 |
|------|------|------|
| 8081 | HTTP API | 所有服务的认证接口 |
| 8899 | 中心服务 | 控制和管理 |
| 7777 | 中心服务 WebSocket | 消息通信 |
| 8866 | 流媒体服务 | 视频流传输 |
| 7788 | 流媒体服务 WebSocket | 视频流控制 |

---

## 📊 系统架构图

```
                    10.10.18.242
┌────────────────────────────────────────────────┐
│                                                │
│  ┌─────────────┐        ┌──────────────┐      │
│  │  中心服务    │◄──────►│  拼接服务     │      │
│  │  aqcenter55 │        │  akss55      │      │
│  │  :8899      │        │  (拼接控制)   │      │
│  │  WS: 7777   │        └──────────────┘      │
│  └─────────────┘                ▲              │
│         ▲                       │              │
│         │                       ▼              │
│         │             ┌──────────────┐         │
│         │             │ 流媒体服务    │         │
│         │             │ akmts55      │         │
│         │             │ :8866        │         │
│         │             │ WS: 7788     │         │
│         │             └──────────────┘         │
│         │                       │              │
│         │                       ▼              │
│         │             ┌──────────────┐         │
│         └────────────►│  录像服务     │         │
│                       │  akrs55      │         │
│                       │  /media/...  │         │
│                       └──────────────┘         │
└────────────────────────────────────────────────┘
         ▲                       ▲
         │                       │
    WS: 7777               WS: 7788
         │                       │
         └───────┬───────────────┘
                 │
         ┌───────▼────────┐
         │   浏览器客户端  │
         │  (React 应用)  │
         └────────────────┘
```

---

## 🎯 视频流工作流程

### 1. 全景画面（4 个主镜头拼接）

```
浏览器
  ↓
登录中心服务 (aqcenter55 @ 10.10.18.242:8081)
  ↓
WebSocket 连接 (ws://10.10.18.242:7777)
  ↓
获取拼接列表 (CMD: 30013)
  ↓
拼接服务返回全景信息
  ↓
打开拼接 (openStitch)
  ↓
创建视频流 (createStream)
  ↓
视频流 WebSocket (ws://10.10.18.242:7788)
  ↓
✅ 全景画面播放（32:9）
```

### 2. 分镜头画面（48 个镜头）

```
浏览器
  ↓
登录中心服务 (aqcenter55)
  ↓
WebSocket 连接 (ws://10.10.18.242:7777)
  ↓
获取通道列表 (CMD: 30007)
  ↓
返回 48 个通道信息
  ↓
点击播放某个通道
  ↓
创建视频流 (createStream)
  ↓
视频流 WebSocket (ws://10.10.18.242:7788)
  ↓
✅ 分镜头画面播放（16:9）
```

---

## 🔑 关键认证信息

### SDK 登录使用

- **账号**：`aqcenter55`（中心服务账号）
- **密码**：`123`
- **服务器**：`10.10.18.242`
- **WebSocket 端口**：`7777`

### 其他服务（SDK 内部使用）

- **流媒体服务 WebSocket**：7788（视频流传输）
- **HTTP API**：8081（所有服务的认证接口）

---

## 📝 注意事项

### 1. 账号区分
- **aqcenter55**：中心服务（SDK 登录用）✅
- **akmts55**：流媒体服务（SDK 内部用）
- **akss55**：拼接服务（SDK 内部用）
- **akrs55**：录像服务（录像回放用）

### 2. 端口区分
- **7777**：中心服务 WebSocket（消息控制）
- **7788**：流媒体服务 WebSocket（视频流）
- **8899**：中心服务 HTTP
- **8866**：流媒体服务 HTTP
- **8081**：统一认证接口

### 3. 视频流路径
- 控制消息：`ws://10.10.18.242:7777`
- 视频数据：`ws://10.10.18.242:7788`（由 SDK 自动处理）

---

## 🌐 网络连通性要求

### 浏览器需要能访问：

- ✅ `http://10.10.18.242:8081` - HTTP API
- ✅ `ws://10.10.18.242:7777` - 中心服务 WebSocket
- ✅ `ws://10.10.18.242:7788` - 流媒体服务 WebSocket

### 测试命令

```powershell
# 测试 HTTP API
curl http://10.10.18.242:8081/aqueti-api/auth/findList

# 测试中心服务 WebSocket
Test-NetConnection -ComputerName 10.10.18.242 -Port 7777

# 测试流媒体服务 WebSocket
Test-NetConnection -ComputerName 10.10.18.242 -Port 7788
```

---

## 🔐 安全建议

### 生产环境

在生产环境中，建议：

1. **使用更强的密码**（不要使用 `123`）
2. **配置 HTTPS/WSS**（加密传输）
3. **配置防火墙规则**（限制访问来源）
4. **使用 JWT Token**（会话管理）
5. **配置 Nginx 反向代理**（统一入口）

### 开发环境

当前配置适用于开发和测试。


